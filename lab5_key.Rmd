---
title: "lab5"
author: "Meghna Rao"
date: "10/25/2021"
output: 
  html_document: 
    theme: yeti
    toc: yes
    code_folding: hide
---

```{r setup, include= TRUE, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
library(tidyverse)
library(effsize)
```

# Additional ways to customize R markdown
If you don't want to track Html files - you can put them in the gitignore folder
- you can also put data in there `*.html`

click setting in r markdown, scroll down to the bottom to output section and explore `output options` it will change the theme of your knit file
- try including a table of contents - check yamel 

## Code folding
giving user the option to see code if they want to but you wan to hide it
in the yamel under `toc: yes`
add in `code_folding: hide`

# Standard deviation

## Part 1: Confidence Intervals

In this section, we'll use the `t.test()` function to calculate confidence intervals.

### Example 1

Create a single mock sample containing a number of values, then learn to use `t.test()` to return confidence intervals, and learn about in-line code referencing so our text becomes more reproducible, too.

```{r}
# Create a mock sample
# create a vector using `c()`

otter_lengths <- c(30, 45, 28, 31, 34, 46, 52, 29)

# lets assume some normality function makes sense here
# here we dont know the population variance and can't use the z distribution so we will use the t distribution to take uncertaintiy into account as well as sample size

# Find confidence interval for t distribution using `t.test(otter_lengths)

t.test(otter_lengths)

# default null hypothesis for this test, gives us the low value of 29.1 and high of 44.64. It means that if shes saying that otter lengths are in inches, what does that confidence interval actually mean?
```
Confidence interval - if we took multiple samples from this and calculated a confidence interval for each of them, we would expect that 95% of the confidence intervals calculated would contain the population mean. 

The output confidence interval might not include the true population parameter.

Problem's with writing out your confidence interval like this: "The mean otter length is 36.9 inches with a 95% confidence interval of [29.1, 44.7] inches"

- need to include sample size
"The mean otter length is 36.9 inches (n=8) with a 95% confidence interval of [29.1, 44.7] inches"

- include some sort of parameter (find standard deviation)

```{r}
# find standard deviation
sd(otter_lengths)
```
"The mean otter length is 36.9 inches $\pm$ 9.3 (mean $\pm$ sd, n=8) with a 95% confidence interval of [29.1, 44.7] inches"

- Now the info is in here, its good, but manually typing in manually means theres an opportunity to mistype the value when you do it by hand. It's dangerous to try to update the text you are including. so we want to build in ways to have the outputs of our code directly tie to the text that's trying to explain that. use inline referencing to refer to outputs of code. need to create and store the outputs

```{r}
otter_ci <- t.test(otter_lengths)

otter_sd <- sd(otter_lengths)
```

- now that you've named things, you can find what the names are for things, check in the console for names if you forget `?t.test` it will populate in the help section
- to call elements of a list use a single dollar sign and the value name you're trying to pull ex `otter_ci$` or `otter_ci$statistic`
- once an object is created an stored, look at the values section of the help section to find what the elements of that object are.

### Now using inline referencing
Now, use the value stored as estimate within `otter_ci` called `statistic`
- add active code within your text with mini code chucks by adding `r`and hit cmd enter to see what the value will be.
- now values created in code can be inline

"Mean otter length is `r otter_ci$estimate`"

- Suppose you want to edit the text of your inline code
- round your value with `r_round`

"Mean otter length is `r round(otter_ci$estimate, 1)` inches"

If ever your sample changes, the inline code will automatically update.

- in confidence interval term if we just put in `otter_ci$conf.int` it will return a vector of length 2 with a low value for the confidence interval and a high value for the confidence interval.
- how can you pull those values? use `[#]` if you want the first value in the vector put a 1 in the # or if you want the second one put a 2 in

### Example of using a confidence interval and inline referencing

"Mean otter length is `r round(otter_ci$estimate, 1)` inches with a 95% confidence interval of [`r round(otter_ci$conf.int[1], 2)`, `r round(otter_ci$conf.int[2], 2)`] inches"

- really valuable with reproducible writing

## Part 2: Two sample t test

If i take in two samples, ask if the sample means are so different that we can reject the null hypothesis that they were drawn from populations with the same mean

### Example 1

Make two mock samples, and ask the question: do we have sufficient evidence to make us reject the null hypothesis that theses samples were drawn from populations with the same mean?

```{r}
# make my mock sampls
oak_trees <- c(20, 19, 24, 28, 34, 12, 15, 25)
  
pine_trees <- c(39, 26, 20, 30, 37, 22, 19, 18)
```

Question being asked: is it so unlikely to get sample means that are so different by random chance that they were drawn from populations of the same mean

```{r}
# two sample t-test. asking if these are different enough in either direction to reject the null hypothesis
tree_t <- t.test(oak_trees, pine_trees)

# null hypothesis : mean heights are the same
# ie.: trees are drawn from populations with the same mean height
```
- default is a welsh two sample t test, null = difference of our sample means is equal to zero. 
what is the probability of being that value or more extreme
what is the probability taht i can take two samples that are at least this far from zero by random chance in either direction. 

"if you took two samples means from populations with the same mean (if these observations were drawn from tree pops w) then there is a 28.7% chance of taking a random sample from each pop and findin that the samples means are at least as different as we found with random chance."

suppose we want less than a 5% chance that we got sample means from populatoins with the same mean.
This difference between sample means here is likely to be found between sample means randomly pulled from populations with the same mean. Therefore I don't think I have enough evidence to think that 

How would you write out "t(df) = t-statistic, p = p-value"

"The mean heights of oak and pine trees were (X +- Y) and (X +- Y), respectively, and the difference was not significant (t(`r tree_t$parameter`) = `r tree_t$statistic`, p = `r tree_t$p.value`)

- what distribution you are using and the sample size "t(df) = input t-statistic, p = p-value"
do not have enough evidence to reject the null hypothesis. 

"t(df) = t-statistic, p = p-value"

*AVOID*: p = 0

When things get really small (usually p < 0.001)

*Not great:* p = 0.0000000000013
*better* p < 0.001

## Part 3: 

Do we think there is a significant diffeence in gas milege between electric cars and gas cars?

### Take and look at data

Using built-in data set `mpg`

```{r}
# use %in% for a vector. want you to look at all rows and if the class column of that row contains either values in that vector I want you to keep that row
compact_suv <- mpg %>% 
  filter(class %in% c("compact", "suv"))

# check for remaining levels, unique checks if filter works
unique(compact_suv$class)

```

Create a histogram of city gas mileage (cty) faceted by class starting from compact_suv. 

Show distribution of gas mileages for compact cars and suvs in the dataset side by side

```{r}
# add facet wrap as a function of class to sep
# facet grid will also include any empty plots 
# change the number of bins
ggplot(data = compact_suv, aes(x = cty)) +
  geom_histogram(bins = 12) +
  facet_wrap(~ class)
```

ex: facet grid will create a grid `facet_grid(Rating~Species)

Based on the central limit theorm, with these sizes we can assume the means would be pretty normally distributed

qq plot plots theoretical values if this was an ideal sample. The closest it is to linear, the closer these samples are to being drawn from the same pop mean

```{r}
ggplot(data = compact_suv, aes(sample = cty)) +
  geom_qq() +
  facet_wrap(~ class)
```

Left graph is mostly linear with some skews in the tail ends. A means comparison is appropriate. So with all that info implied I feel comfortable using a two sample t test.

decide its appropriate to use means and t tests to compare these two samples

Find summary statistics for each group use `group_by` and `summarize

```{r}
# you can group by multiple varibales but here we only need one
car_stats <- compact_suv %>% 
  group_by(class) %>% 
  summarize(
    mean_city = mean(cty),
    sd_city = sd(cty),
    sample_size = n()
  )
```

The T-test() function really wants vectors of things. use the pull() function to pull out a vector fram a data frame **rare to do**

```{r}
compact_sample <- compact_suv %>% 
  filter(class == "compact") %>% 
  pull(cty)
```

### Your turn: do the same thing to get a vector of city gas mileages for SUVs

```{r}
suv_sample <- compact_suv %>% 
  filter(class == "suv") %>% 
  pull(cty)
```

HAVE YOU DETERMIEND

use a t test ot test null hyoothesis that mean city gas mileages for suvs and compact cares are the same.
we are using a t test to see if we have enough evidence to reject the null hypothesis.

```{r}
t.test(compact_sample, suv_sample)
```

Is it possible that these samples are drawn from populations with the same mean gas milage? Yes. but is it likely? No.
We would definitley rejct the null hypothesis that the mean gas mileages are the same.

There is a significat difference in mean city gas mileage between compact cars and suvs (then write in summary inline) (t(df) = t-statistic, p < p.value)
